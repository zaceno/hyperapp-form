var hyperappform=function(e){let t;const a=(r=(e,{e:t})=>t.preventDefault(),e=>[r,{e:e}]);var r;const s=(e=>(t,a)=>[e,{a:t,p:a}])((e,{a:t,p:a})=>e(t,a)),l=(e,{event:t,onsubmit:r,validators:l,getFormState:o,setFormState:i})=>{let d=o(e);if(d.submitted)return e;let n=Object.fromEntries(Object.entries(l).map(([e,t])=>[e,t(d.values[e],d.values)])),u=Object.entries(n).reduce((e,[t,a])=>e&&!a,!0);return[i(e,{...d,errors:n,submitted:u}),u&&s(r,d.values),a(t)]},o=(e,{name:t,value:a,getFormState:r,setFormState:s},l=r(e))=>l.submitted?e:s(e,{...l,values:{...l.values,[t]:a}}),i=(e,{name:t,validators:a,getFormState:r,setFormState:s},l=r(e))=>l.submitted?e:s(e,{...l,errors:{...l.errors,[t]:a[t]?a[t](l.values[t],l.values):""}}),d=(e,t)=>[e,s(o,t),s(i,t)],n=(e,t)=>Array.isArray(t)?t.map(t=>n(e,t)):t.f?t.provider&&t.provider===n?(t=t.f(e)).props?t:{name:t,type:3,children:[],props:{}}:t:{...t,children:n(e,t.children)},u=e=>({f:e,provider:n}),m=(e,t,a)=>u(({state:r,validators:s,getFormState:l,setFormState:n})=>(t&&(s[e]=t),a({value:r.values[e],error:r.errors[e],disabled:r.submitted,Set:[o,t=>({getFormState:l,setFormState:n,name:e,value:t,validators:s})],Validate:[i,{name:e,getFormState:l,setFormState:n,validators:s}],SetAndValidate:[d,t=>({name:e,value:t,validators:s,getFormState:l,setFormState:n})]}))),v=e=>m(e.name,e.validator,({value:a,error:r,disabled:s,Set:l,Validate:o,SetAndValidate:i})=>t("input",{...e,type:e.type||"text",class:[e.class,{error:!!r}],disabled:s,name:e.name,value:a,oninput:[r?i:l,e=>e.target.value],...void 0===a?{}:{onblur:o}})),c=e=>m(e.name,e.validator,({value:a,error:r,disabled:s,SetAndValidate:l})=>t("input",{...e,type:"radio",class:[e.class,{error:r}],name:e.name,value:e.value||"on",disabled:s,checked:a===(e.value||"on"),onchange:[l,e.value||"on"]})),p=e=>m(e.name,e.validator,({value:a,error:r,disabled:s,SetAndValidate:l},o=e.value||"on")=>t("input",{...e,type:"checkbox",class:[e.class,{error:r}],disabled:s,checked:Array.isArray(a)?a.indexOf(o)>=0:a===o,name:e.name,value:o,onchange:[l,(e,t=[...(a?Array.isArray(a)?a:[a]:[]).filter(e=>e!==o),...e.target.checked?[o]:[]])=>t.length>1?t:1==t.length?t[0]:""]}));return e.bind=e=>t=e,e.check=p,e.error=()=>u(({state:e})=>Object.entries(e.errors).reduce((e,[t,a])=>e||a,"")),e.form=({appState:e,getFormState:a,setFormState:r,onsubmit:s},o)=>{let i={};return t("form",{onsubmit:[l,e=>({event:e,onsubmit:s,validators:i,getFormState:a,setFormState:r})]},n({validators:i,state:a(e),getFormState:a,setFormState:r},o))},e.init=(e={},t={})=>({values:e,errors:t,submitted:!1}),e.input=e=>"checkbox"===e.type?p(e):"radio"===e.type?c(e):v(e),e.radio=c,e.select=(e,a)=>m(e.name,e.validator,({value:r,error:s,disabled:l,SetAndValidate:o})=>t("select",{...e,appendChild(e){return r===e.value&&e.setAttribute("selected","selected"),Element.prototype.appendChild.call(this,e)},class:[e.class,{error:s}],name:e.name,value:r,disabled:l,oninput:[o,e=>e.target.value]},a)),e.submit=(e,a)=>u(({state:r})=>t("button",{...e,type:"submit",disabled:r.submitted},a)),e.text=v,e.widget=m,e}({});
//# sourceMappingURL=hyperappform.js.map